@page
@using Hillerød_Sejklub.Models
@model Hillerød_Sejklub.Pages.BoatsModel
@{
    ViewData["Title"] = "Både";
}

<h1 class="text-center">Liste af vores både</h1>
<p class="text-center">Her kan du se en liste af de både vi tilbyder i Hillerød Sejlklub.</p>

<h2>Sejlbåde</h2>
<div class="row">
    @foreach (Sailboat sailboat in Model.Sailboats)
    {
        <div class="col-md-4">
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">@sailboat.Name</h5>
                    <p class="card-text">Model: @sailboat.Model</p>
                    <p class="card-text">Årgang: @sailboat.BuildYear</p>
                    <p class="card-text">Antal sejl: @sailboat.NumberOfSails</p>
                </div>
            </div>
        </div>
    }
</div>

<h2>Motorbåde</h2>
<div class="row">
    @foreach (Motorboat motorboat in Model.Motorboats)
    {
        <div class="col-md-4">
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">@motorboat.Name</h5>
                    <img src="Media/indexfoto1.jpg" class="card-img-top" alt="Indexfoto1">
                    <p class="card-text">Model: @motorboat.Model</p>
                    <p class="card-text">Årgang: @motorboat.BuildYear</p>
                    <p class="card-text">Motortype: @motorboat.EngineType</p>
                </div>
            </div>
        </div>
    }
</div>
<table>

    <tbody>
        @foreach (Boats boat in Model.BoatsList)
        {
            <tr>
                <td>@boat.Name</td>
                <td>@boat.Model</td>
                <td>@boat.SailNumber</td>
                <td>@boat.EngineInfo</td>
                <td>@boat.BuildYear</td>
                <td>@(boat.IsAvailable ? "Yes" : "No")</td>
            </tr>
        }
    </tbody>
    <!DOCTYPE html>
    <html lang="da">
    <head>
        <meta charset="UTF-8" />
        <title>Båd Booking</title>
    </head>
    <body>
        <h1>Book en Båd</h1>
        <form id="bookingForm">
            <label for="bådID">Båd ID:</label>
            <input type="number" id="bådID" name="bådID" required /><br /><br />

            <label for="medlemsID">Medlems ID:</label>
            <input type="number" id="medlemsID" name="medlemsID" required /><br /><br />

            <label for="sejlTid">Sejltid:</label>
            <input type="datetime-local" id="sejlTid" name="sejlTid" required /><br /><br />

            <label for="mødested">Mødested:</label>
            <input type="text" id="mødested" name="mødested" required /><br /><br />

            <button type="button" onclick="bookBåd()">Book båd</button>
        </form>

        <h2>Booking Log</h2>
        <ul id="bookingLog"></ul>

        <script>
            // Simulerer en liste over bookinger
            let bookings = [];

            function generateBookingID() {
                // simpel tæl-lejellem
                if (!generateBookingID.counter) generateBookingID.counter = 1;
                return generateBookingID.counter++;
            }

            function bookBåd() {
                const bådID = parseInt(document.getElementById('bådID').value);
                const medlemsID = parseInt(document.getElementById('medlemsID').value);
                const sejlTidStr = document.getElementById('sejlTid').value;
                const mødested = document.getElementById('mødested').value;

                const sejlTid = new Date(sejlTidStr);

                // Tjekker tilgængelighed
                const erTilgængelig = bookings.every(b => b.BådID !== bådID || b.SejlTid.getTime() !== sejlTid.getTime());

                if (!erTilgængelig) {
                    alert('Båden er allerede booket til dette tidspunkt.');
                    return;
                }

                const nyBookingID = generateBookingID();

                const nyBooking = {
                    BookingID: nyBookingID,
                    BådID: bådID,
                    MedlemsID: medlemsID,
                    SejlTid: sejlTid,
                    Mødested: mødested
                };

                bookings.push(nyBooking);
                addBookingToLog(nyBooking);
                alert('Båd er blevet booket.');
            }

            function addBookingToLog(booking) {
                const ul = document.getElementById('bookingLog');
                const li = document.createElement('li');
                li.textContent = `BookingID: ${booking.BookingID}, BådID: ${booking.BådID}, MedlemsID: ${booking.MedlemsID}, SejlTid: ${booking.SejlTid.toLocaleString()}, Mødested: ${booking.Mødested}`;
                ul.appendChild(li);
            }
      
        </script>
    </body>
</html>
</table>
